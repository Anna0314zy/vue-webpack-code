# 1.基础

## 1.概念

![WX20201123-091449@2x](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/WX20201123-091449@2x.png)

对比 [Node.js 模块](https://nodejs.org/api/modules.html)，webpack *模块*能够以各种方式表达它们的依赖关系，几个例子如下：

- [ES2015 `import`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import) 语句
- [CommonJS](http://www.commonjs.org/specs/modules/1.0/) `require()` 语句
- [AMD](https://github.com/amdjs/amdjs-api/blob/master/AMD.md) `define` 和 `require` 语句
- css/sass/less 文件中的 [`@import` 语句](https://developer.mozilla.org/en-US/docs/Web/CSS/@import)。
- 样式(`url(...)`)或 HTML 文件(`<img src=...>`)中的图片链接(image url)

mode

配置模式 启用webpack优化 三个选项

-  develompment
- production
- Node

![image-20201123102655278](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201123102655278.png)

![image-20201123141700047](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201123141700047.png)

## 2.webpack-dev-server

```js
devServer: {
    contentBase: path.resolve(__dirname, 'dist'), //产出文件的根目录
    port: 8080,
    host: 'localhost',
    compress: true
},
```

## 3.html-webpack-plugin

```js
plugins: [
    //产出html文件
    new HtmlWebpackPlugin({
        template: "./src/index.html",
        filename: 'index.html',
        hash: true, //为了避免缓存，可以在产出的文件后面加hash值
        //chunks: ['common', 'index'], //指定引入的代码块  用的不多 感觉不好使
        //chunksSortMode: "manual" //对引入的代码块进行排序的模式
    })
]
```

## 4.loader

![image-20201123151102639](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201123151102639.png)

![image-20201124105629691](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124105629691.png)

logo 最后被打包成fd5生成的hash值

 把图片拷贝到dist目录 更改了文件名 文件名被打包成fd5生成的hash值 

![image-20201124111350686](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124111350686.png)

![image-20201124112812808](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124112812808.png)



![image-20201124112852995](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124112852995.png)

打包后的结果

![image-20201124112655850](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124112655850.png)

file-loader  把文件拷贝过去 改一下文件名 变更路径 相对路径

url-loader是file-loader的增强

有些时候 需要一些内联 有些文件比较小 不需要生成文件

```js
url-loader需要传参 options: {limit: 10*1024}
url-loader 内置了file-loader
加载的图片小于10k 就转换成base64编码 内嵌到网页中去
```

## 5.clean-webpack-plugin

npm install --save-dev clean-webpack-plugin

const { CleanWebpackPlugin } **=** require('clean-webpack-plugin');

```
 plugins: [
        /**
         * All files inside webpack's output.path directory will be removed once, but the
         * directory itself will not be. If using webpack 4+'s default configuration,
         * everything under <PROJECT_DIR>/dist/ will be removed.
         * Use cleanOnceBeforeBuildPatterns to override this behavior.
         *
         * During rebuilds, all webpack assets that are not used anymore
         * will be removed automatically.
         *
         * See `Options and Defaults` for information
         */
        new CleanWebpackPlugin(),
    ],
```

## 6.分离css

mini-css-extract-plugin

![image-20201124134329342](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124134329342.png)

![image-20201124135644297](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124135644297.png)

```js
plugins:[
   new MiniCssExtractPlugin({
            filename: '[name].css', //name 代码块chunk的名字
            chunkFilename: '[id].css' //代码块的名字 在异步加载的时候用的 分割代码块然后异步加载
        }) //分离css
]
```

## 7.压缩js css

![image-20201124141848252](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124141848252.png)

uglifyjs-webpack-plugin  terser-webpack-plugin optimize-css-assets-webpack-plugin

## 8.css js存放单独的目录

![image-20201124152033069](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124152033069.png)

![image-20201124152235549](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124152235549.png)

![image-20201124152252568](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124152252568.png)

hash代表本次的编译 每编译一次就会产生新的文件

chunkhash代码块的hash  每个entry都会产生一个chunk

```js
entry: {
  vendor: ['react', 'react-dom'],
  index: 'src/index.js'
}
output: {
  filename: '[name].[hash:8]js'
}
//产生2个chunk vendor index 
index.html 设置不缓存
index.js 设置hash值 文件名变了 就请求新的资源 不用缓存的
vendor.js --- 放到cdn 实现缓存
默认情况：index.js改变了  vendor也会跟着改变
现在我不想让vendor改变 
1.chunkhash
 new MiniCssExtractPlugin({
            filename: '[name][hash][chunkhash].css', //name 代码块chunk的名字
            //chunkhash 只要打包后的模块有一个发生了变化 都会改变
            chunkFilename: '[id].css' //代码块的名字 在异步加载的时候用的 分割代码块然后异步加载
        }) //分离css
2.contenthash
new MiniCssExtractPlugin({
            filename: '[name][contenthash].css', //name 代码块chunk的名字
            //chunkhash 只要打包后的模块有一个发生了变化 都会改变
            chunkFilename: '[id].css' //代码块的名字 在异步加载的时候用的 分割代码块然后异步加载
        }) //分离css
```

## 9.html使用src

![image-20201124163908363](/Users/zouyu/Desktop/vue-webpack-code/webpack-dev/img/image-20201124163908363.png)



